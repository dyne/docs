
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://dyne.org/docs/cjit/builtins/">
      
      
        <link rel="prev" href="../graphics/">
      
      
        <link rel="next" href="../faq/">
      
      
      <link rel="icon" href="../images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.47">
    
    
      
        <title>Builtins - CJIT Manual</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.6f8fc17f.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#cjit-built-in-extensions" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="CJIT Manual" class="md-header__button md-logo" aria-label="CJIT Manual" data-md-component="logo">
      
  <img src="../images/dyneorg.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            CJIT Manual
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Builtins
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="CJIT Manual" class="md-nav__button md-logo" aria-label="CJIT Manual" data-md-component="logo">
      
  <img src="../images/dyneorg.svg" alt="logo">

    </a>
    CJIT Manual
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Introduction
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../graphics/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Graphics
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Builtins
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Builtins
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#filesystem-monitoring" class="md-nav__link">
    <span class="md-ellipsis">
      Filesystem monitoring
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#audio-play-and-record" class="md-nav__link">
    <span class="md-ellipsis">
      Audio play and record
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#terminal-user-interface" class="md-nav__link">
    <span class="md-ellipsis">
      Terminal User Interface
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../faq/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    FAQ
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#filesystem-monitoring" class="md-nav__link">
    <span class="md-ellipsis">
      Filesystem monitoring
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#audio-play-and-record" class="md-nav__link">
    <span class="md-ellipsis">
      Audio play and record
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#terminal-user-interface" class="md-nav__link">
    <span class="md-ellipsis">
      Terminal User Interface
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="cjit-built-in-extensions">CJIT built-in extensions</h1>
<p>CJIT is equipped with a range of built-in extensions designed to
enhance the capabilities of your C scripts. These extensions allow you
to perform a variety of operations easily and efficiently, adding a
layer of versatility to your coding experience. Whether you're
manipulating data, handling complex computations, accessing 3D
acceleration or drawing on the terminal or monitoring filesystem
changes, our built-ins extensions provide additional function calls to
make your scripting both powerful and fun.</p>
<p>Our selection of extension is guided by a choice of minimalism and
portability. Below you'll see a list of what we ship and link to
respective vendors.</p>
<h2 id="filesystem-monitoring">Filesystem monitoring</h2>
<p>The <a href="https://github.com/septag/dmon/">dmon</a> built-in is designed for
monitoring changes in the filesystem. This extension simplifies the
process of tracking file modifications, deletions, and creations,
allowing you to respond to these events in real time within your C
scripts.</p>
<p>Here and in
<a href="https://github.com/dyne/cjit/blob/main/examples/dmon.c">examples/dmon.c</a>
is some example code working on all platforms:</p>
<div class="highlight"><pre><span></span><code><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;stdio.h&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;dmon.h&gt;</span>

<span class="k">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">watch_callback</span><span class="p">(</span><span class="n">dmon_watch_id</span><span class="w"> </span><span class="n">watch_id</span><span class="p">,</span>
<span class="w">                           </span><span class="n">dmon_action</span><span class="w"> </span><span class="n">action</span><span class="p">,</span>
<span class="w">                           </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="o">*</span><span class="w"> </span><span class="n">rootdir</span><span class="p">,</span>
<span class="w">                           </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="o">*</span><span class="w"> </span><span class="n">filepath</span><span class="p">,</span>
<span class="w">                           </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="o">*</span><span class="w"> </span><span class="n">oldfilepath</span><span class="p">,</span>
<span class="w">                           </span><span class="kt">void</span><span class="o">*</span><span class="w"> </span><span class="n">user</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="p">(</span><span class="kt">void</span><span class="p">)(</span><span class="n">user</span><span class="p">);</span>
<span class="w">    </span><span class="p">(</span><span class="kt">void</span><span class="p">)(</span><span class="n">watch_id</span><span class="p">);</span>
<span class="w">    </span><span class="k">switch</span><span class="w"> </span><span class="p">(</span><span class="n">action</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="no">DMON_ACTION_CREATE</span><span class="p">:</span>
<span class="w">        </span><span class="n">fprintf</span><span class="p">(</span><span class="n">stderr</span><span class="p">,</span><span class="s">&quot;CREATE: [%s]%s</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">rootdir</span><span class="p">,</span><span class="w"> </span><span class="n">filepath</span><span class="p">);</span>
<span class="w">        </span><span class="k">break</span><span class="p">;</span>
<span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="no">DMON_ACTION_DELETE</span><span class="p">:</span>
<span class="w">        </span><span class="n">fprintf</span><span class="p">(</span><span class="n">stderr</span><span class="p">,</span><span class="s">&quot;DELETE: [%s]%s</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">rootdir</span><span class="p">,</span><span class="w"> </span><span class="n">filepath</span><span class="p">);</span>
<span class="w">        </span><span class="k">break</span><span class="p">;</span>
<span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="no">DMON_ACTION_MODIFY</span><span class="p">:</span>
<span class="w">        </span><span class="n">fprintf</span><span class="p">(</span><span class="n">stderr</span><span class="p">,</span><span class="s">&quot;MODIFY: [%s]%s</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">rootdir</span><span class="p">,</span><span class="w"> </span><span class="n">filepath</span><span class="p">);</span>
<span class="w">        </span><span class="k">break</span><span class="p">;</span>
<span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="no">DMON_ACTION_MOVE</span><span class="p">:</span>
<span class="w">        </span><span class="n">fprintf</span><span class="p">(</span><span class="n">stderr</span><span class="p">,</span><span class="s">&quot;MOVE: [%s]%s -&gt; [%s]%s</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span>
<span class="w">          </span><span class="n">rootdir</span><span class="p">,</span><span class="w"> </span><span class="n">oldfilepath</span><span class="p">,</span><span class="w"> </span><span class="n">rootdir</span><span class="p">,</span><span class="w"> </span><span class="n">filepath</span><span class="p">);</span>
<span class="w">        </span><span class="k">break</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">argc</span><span class="p">,</span><span class="w"> </span><span class="kt">char</span><span class="o">*</span><span class="w"> </span><span class="n">argv</span><span class="p">[])</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">argc</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">dmon_init</span><span class="p">();</span>
<span class="w">        </span><span class="n">puts</span><span class="p">(</span><span class="s">&quot;waiting for changes ..&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="n">dmon_watch</span><span class="p">(</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="w"> </span><span class="n">watch_callback</span><span class="p">,</span>
<span class="w">          </span><span class="n">DMON_WATCHFLAGS_RECURSIVE</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">);</span>
<span class="w">        </span><span class="n">getchar</span><span class="p">();</span>
<span class="w">        </span><span class="n">dmon_deinit</span><span class="p">();</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">puts</span><span class="p">(</span><span class="s">&quot;usage: test dirname&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>
<h2 id="audio-play-and-record">Audio play and record</h2>
<p>The <a href="https://miniaud.io">miniaudio</a> built-in handles audio playback
and capture with ease. With this extension, you can seamlessly
integrate audio functionality into your C scripts, creating immersive
and interactive experiences for your users.</p>
<p>Miniaudio provides two main sources of documentation</p>
<ul>
<li><a href="https://miniaud.io/docs/manual/index.html">The miniaudio Programmer's manual</a></li>
<li><a href="https://miniaud.io/docs/examples/index.html">Various miniaudio examples</a></li>
</ul>
<p>Miniaudio includes both low level and high level APIs. The low level
API is good for those who want to do all of their mixing themselves
and only require a light weight interface to the underlying audio
device. The high level API is good for those who have complex mixing
and effect requirements.</p>
<p>In miniaudio, objects are transparent structures. Unlike many other
libraries, there are no handles to opaque objects which means you need
to allocate memory for objects yourself.</p>
<p>A config/init pattern is used throughout the entire library. The idea
is that you set up a config object and pass that into the
initialization routine. The advantage to this system is that the
config object can be initialized with logical defaults and new
properties added to it without breaking the API.</p>
<p>Below and in
<a href="https://github.com/dyne/cjit/blob/main/examples/miniaudio.c">examples/miniaudio.c</a>
is an example of sin wave synthesis that runs smoothly in CJIT:</p>
<div class="highlight"><pre><span></span><code><span class="cp">#define MA_NO_DECODING</span>
<span class="cp">#define MA_NO_ENCODING</span>
<span class="cp">#define MINIAUDIO_IMPLEMENTATION</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;miniaudio.h&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;stdio.h&gt;</span>
<span class="cp">#define DEVICE_FORMAT       ma_format_f32</span>
<span class="cp">#define DEVICE_CHANNELS     2</span>
<span class="cp">#define DEVICE_SAMPLE_RATE  48000</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">data_callback</span><span class="p">(</span><span class="n">ma_device</span><span class="o">*</span><span class="w"> </span><span class="n">pDevice</span><span class="p">,</span>
<span class="w">                   </span><span class="kt">void</span><span class="o">*</span><span class="w"> </span><span class="n">pOutput</span><span class="p">,</span>
<span class="w">                   </span><span class="k">const</span><span class="w"> </span><span class="kt">void</span><span class="o">*</span><span class="w"> </span><span class="n">pInput</span><span class="p">,</span>
<span class="w">                   </span><span class="n">ma_uint32</span><span class="w"> </span><span class="n">frameCount</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">ma_waveform</span><span class="o">*</span><span class="w"> </span><span class="n">pSineWave</span><span class="p">;</span>
<span class="w">    </span><span class="n">MA_ASSERT</span><span class="p">(</span><span class="n">pDevice</span><span class="o">-&gt;</span><span class="n">playback</span><span class="p">.</span><span class="n">channels</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">DEVICE_CHANNELS</span><span class="p">);</span>
<span class="w">    </span><span class="n">pSineWave</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">ma_waveform</span><span class="o">*</span><span class="p">)</span><span class="n">pDevice</span><span class="o">-&gt;</span><span class="n">pUserData</span><span class="p">;</span>
<span class="w">    </span><span class="n">MA_ASSERT</span><span class="p">(</span><span class="n">pSineWave</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">);</span>
<span class="w">    </span><span class="n">ma_waveform_read_pcm_frames</span><span class="p">(</span><span class="n">pSineWave</span><span class="p">,</span><span class="w"> </span><span class="n">pOutput</span><span class="p">,</span><span class="w"> </span><span class="n">frameCount</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">);</span>
<span class="w">    </span><span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="n">pInput</span><span class="p">;</span><span class="w">   </span><span class="cm">/* Unused in this example. */</span>
<span class="p">}</span>

<span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">argc</span><span class="p">,</span><span class="w"> </span><span class="kt">char</span><span class="o">**</span><span class="w"> </span><span class="n">argv</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">ma_waveform</span><span class="w"> </span><span class="n">sineWave</span><span class="p">;</span>
<span class="w">    </span><span class="n">ma_device_config</span><span class="w"> </span><span class="n">deviceConfig</span><span class="p">;</span>
<span class="w">    </span><span class="n">ma_device</span><span class="w"> </span><span class="n">device</span><span class="p">;</span>
<span class="w">    </span><span class="n">ma_waveform_config</span><span class="w"> </span><span class="n">sineWaveConfig</span><span class="p">;</span>
<span class="w">    </span><span class="n">deviceConfig</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ma_device_config_init</span><span class="p">(</span><span class="n">ma_device_type_playback</span><span class="p">);</span>
<span class="w">    </span><span class="n">deviceConfig</span><span class="p">.</span><span class="n">playback</span><span class="p">.</span><span class="n">format</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">DEVICE_FORMAT</span><span class="p">;</span>
<span class="w">    </span><span class="n">deviceConfig</span><span class="p">.</span><span class="n">playback</span><span class="p">.</span><span class="n">channels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DEVICE_CHANNELS</span><span class="p">;</span>
<span class="w">    </span><span class="n">deviceConfig</span><span class="p">.</span><span class="n">sampleRate</span><span class="w">        </span><span class="o">=</span><span class="w"> </span><span class="n">DEVICE_SAMPLE_RATE</span><span class="p">;</span>
<span class="w">    </span><span class="n">deviceConfig</span><span class="p">.</span><span class="n">dataCallback</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="n">data_callback</span><span class="p">;</span>
<span class="w">    </span><span class="n">deviceConfig</span><span class="p">.</span><span class="n">pUserData</span><span class="w">         </span><span class="o">=</span><span class="w"> </span><span class="o">&amp;</span><span class="n">sineWave</span><span class="p">;</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ma_device_init</span><span class="p">(</span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">deviceConfig</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">device</span><span class="p">)</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">MA_SUCCESS</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;Failed to open playback device.</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="mi">-4</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;Device Name: %s</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">device</span><span class="p">.</span><span class="n">playback</span><span class="p">.</span><span class="n">name</span><span class="p">);</span>
<span class="w">    </span><span class="n">sineWaveConfig</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ma_waveform_config_init</span><span class="p">(</span><span class="n">device</span><span class="p">.</span><span class="n">playback</span><span class="p">.</span><span class="n">format</span><span class="p">,</span>
<span class="w">                                             </span><span class="n">device</span><span class="p">.</span><span class="n">playback</span><span class="p">.</span><span class="n">channels</span><span class="p">,</span>
<span class="w">                                             </span><span class="n">device</span><span class="p">.</span><span class="n">sampleRate</span><span class="p">,</span>
<span class="w">                                             </span><span class="n">ma_waveform_type_sine</span><span class="p">,</span>
<span class="w">                                             </span><span class="mf">0.2</span><span class="p">,</span><span class="w"> </span><span class="mi">220</span><span class="p">);</span>
<span class="w">    </span><span class="n">ma_waveform_init</span><span class="p">(</span><span class="o">&amp;</span><span class="n">sineWaveConfig</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">sineWave</span><span class="p">);</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ma_device_start</span><span class="p">(</span><span class="o">&amp;</span><span class="n">device</span><span class="p">)</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">MA_SUCCESS</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;Failed to start playback device.</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="n">ma_device_uninit</span><span class="p">(</span><span class="o">&amp;</span><span class="n">device</span><span class="p">);</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="mi">-5</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;Press Enter to quit...</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="n">getchar</span><span class="p">();</span>
<span class="w">    </span><span class="n">ma_device_uninit</span><span class="p">(</span><span class="o">&amp;</span><span class="n">device</span><span class="p">);</span>
<span class="w">    </span><span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="n">argc</span><span class="p">;</span>
<span class="w">    </span><span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="n">argv</span><span class="p">;</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>
<h2 id="terminal-user-interface">Terminal User Interface</h2>
<p>Believe it or not, one can draw a beautiful terminal user interface
(also called TUI) on a text console, with colors and blinking lights
too. Our built-in <a href="https://github.com/termbox/termbox2">termbox2</a>
allows this in an API that improves a lot on old approaches as ncurses
or slang, by <a href="https://suckless.org">sucking much less</a> <code>:^)</code></p>
<p>Here is a quick synopsis:</p>
<div class="highlight"><pre><span></span><code><span class="cp">#define TB_IMPL</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;termbox2.h&quot;</span>

<span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">argc</span><span class="p">,</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">**</span><span class="n">argv</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">struct</span><span class="w"> </span><span class="nc">tb_event</span><span class="w"> </span><span class="n">ev</span><span class="p">;</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>

<span class="w">    </span><span class="n">tb_init</span><span class="p">();</span>

<span class="w">    </span><span class="n">tb_printf</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="o">++</span><span class="p">,</span><span class="w"> </span><span class="n">TB_GREEN</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;hello from termbox&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="n">tb_printf</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="o">++</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;width=%d height=%d&quot;</span><span class="p">,</span>
<span class="w">              </span><span class="n">tb_width</span><span class="p">(),</span><span class="w"> </span><span class="n">tb_height</span><span class="p">());</span>
<span class="w">    </span><span class="n">tb_printf</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="o">++</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;press any key...&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="n">tb_present</span><span class="p">();</span>

<span class="w">    </span><span class="n">tb_poll_event</span><span class="p">(</span><span class="o">&amp;</span><span class="n">ev</span><span class="p">);</span>

<span class="w">    </span><span class="n">y</span><span class="o">++</span><span class="p">;</span>
<span class="w">    </span><span class="n">tb_printf</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="o">++</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;event type=%d key=%d ch=%c&quot;</span><span class="p">,</span>
<span class="w">              </span><span class="n">ev</span><span class="p">.</span><span class="n">type</span><span class="p">,</span><span class="w"> </span><span class="n">ev</span><span class="p">.</span><span class="n">key</span><span class="p">,</span><span class="w"> </span><span class="n">ev</span><span class="p">.</span><span class="n">ch</span><span class="p">);</span>
<span class="w">    </span><span class="n">tb_printf</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="o">++</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;press any key to quit...&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="n">tb_present</span><span class="p">();</span>

<span class="w">    </span><span class="n">tb_poll_event</span><span class="p">(</span><span class="o">&amp;</span><span class="n">ev</span><span class="p">);</span>
<span class="w">    </span><span class="n">tb_shutdown</span><span class="p">();</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>
<p>The termbox2 basic API is self explanatory:</p>
<div class="highlight"><pre><span></span><code><span class="kt">int</span><span class="w"> </span><span class="nf">tb_init</span><span class="p">();</span>
<span class="kt">int</span><span class="w"> </span><span class="nf">tb_shutdown</span><span class="p">();</span>

<span class="kt">int</span><span class="w"> </span><span class="nf">tb_width</span><span class="p">();</span>
<span class="kt">int</span><span class="w"> </span><span class="nf">tb_height</span><span class="p">();</span>

<span class="kt">int</span><span class="w"> </span><span class="nf">tb_clear</span><span class="p">();</span>
<span class="kt">int</span><span class="w"> </span><span class="nf">tb_present</span><span class="p">();</span>

<span class="kt">int</span><span class="w"> </span><span class="nf">tb_set_cursor</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">cx</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">cy</span><span class="p">);</span>
<span class="kt">int</span><span class="w"> </span><span class="nf">tb_hide_cursor</span><span class="p">();</span>

<span class="kt">int</span><span class="w"> </span><span class="nf">tb_set_cell</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">ch</span><span class="p">,</span>
<span class="w">                </span><span class="n">uintattr_t</span><span class="w"> </span><span class="n">fg</span><span class="p">,</span><span class="w"> </span><span class="n">uintattr_t</span><span class="w"> </span><span class="n">bg</span><span class="p">);</span>

<span class="kt">int</span><span class="w"> </span><span class="nf">tb_peek_event</span><span class="p">(</span><span class="k">struct</span><span class="w"> </span><span class="nc">tb_event</span><span class="w"> </span><span class="o">*</span><span class="n">event</span><span class="p">,</span>
<span class="w">                  </span><span class="kt">int</span><span class="w"> </span><span class="n">timeout_ms</span><span class="p">);</span>
<span class="kt">int</span><span class="w"> </span><span class="nf">tb_poll_event</span><span class="p">(</span><span class="k">struct</span><span class="w"> </span><span class="nc">tb_event</span><span class="w"> </span><span class="o">*</span><span class="n">event</span><span class="p">);</span>

<span class="kt">int</span><span class="w"> </span><span class="nf">tb_print</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">y</span><span class="p">,</span>
<span class="w">             </span><span class="n">uintattr_t</span><span class="w"> </span><span class="n">fg</span><span class="p">,</span><span class="w"> </span><span class="n">uintattr_t</span><span class="w"> </span><span class="n">bg</span><span class="p">,</span>
<span class="w">             </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">str</span><span class="p">);</span>
<span class="kt">int</span><span class="w"> </span><span class="nf">tb_printf</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">y</span><span class="p">,</span>
<span class="w">              </span><span class="n">uintattr_t</span><span class="w"> </span><span class="n">fg</span><span class="p">,</span><span class="w"> </span><span class="n">uintattr_t</span><span class="w"> </span><span class="n">bg</span><span class="p">,</span>
<span class="w">              </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">fmt</span><span class="p">,</span><span class="w"> </span><span class="p">...);</span>
</code></pre></div>
<p>To see a demo of what it can do, see the
<a href="https://github.com/dyne/cjit/blob/main/examples/termbox2.c">examples/termbox.c</a>
example which will draw a keyboard on your terminal and show the keys
you are pressing in real-time. Its code is a great source of knowledge
about what termbox2 can do!</p>












                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      CJIT Manual written by <a href="https://jaromil.dyne.org">Jaromil</a>, Copyright &copy; 2024-2025 <a href="https://dyne.org">Dyne.org Foundation</a>
    </div>
  
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/dyne/cjit" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://www.linkedin.com/company/dyne-org/" target="_blank" rel="noopener" title="www.linkedin.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3M135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5m282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": ["content.tabs.link"], "search": "../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.83f73b43.min.js"></script>
      
    
  </body>
</html>